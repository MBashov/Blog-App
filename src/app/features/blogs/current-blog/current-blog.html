<article class="blog-details">

    <header class="blog-header">
        <h1 class="blog-title">{{blog.title | titlecase}}</h1>
        <div class="blog-meta">
            <span class="author">by {{blog.author.firstName}} {{blog.author.lastName}}</span>
            <span class="date">{{blog.publishedAt | date: 'longDate'}}</span>
        </div>
    </header>

    <span class="blog-banner" [ngClass]="imageClass">
        <img [ngClass]="imageClass" src="{{blog.banner.url}}" alt="Post Banner" (load)="onImageLoad($event)" />
    </span>

    <section class="blog-content">
        <p>{{blog.content}}</p>
    </section>

    <section class="blog-gallery">
        <h4>More images</h4>
        <div class="image-scroll-wrapper">
            <button class="scroll-btn-left" (click)="scrollImages('left')"><span><i
                        class="fa-solid fa-angle-left"></i></span></button>
            <div class="images" #imageContainer>
                <img (click)="showModal($event)" src="background-img.jpg" alt="img">
                <img (click)="showModal($event)" src="background-img2.jpg" alt="img">
                <img (click)="showModal($event)" src="ocean.jpeg" alt="img">
                <img (click)="showModal($event)" src="background-img.jpg" alt="img">
                <img (click)="showModal($event)" src="ocean.jpeg" alt="img">
                <img (click)="showModal($event)" src="background-img.jpg" alt="img">
            </div>
            <button class="scroll-btn-right" (click)="scrollImages('right')"><span><i
                        class="fa-solid fa-angle-right"></i></span></button>
        </div>
        <div class="modal" [ngClass]="modalClass" (click)="closeModal()">
            <div class="modal-content">
                <span class="close" (click)="closeModal()"><i class="fas fa-times"></i></span>
                <img class="modal-img" (click)="$event.stopPropagation()" src="{{imageSrc}}" alt="">
                <span class="modal-text">{{blog.title}}</span>
            </div>
        </div>
    </section>

    <footer class="blog-footer">
        <div class="stats">
            <span><i class="fa-regular fa-eye"></i> {{blog.viewsCount}} {{blog.viewsCount === 1 ? 'view' : 'views'}}</span>
            <span><i class="fa-regular fa-thumbs-up"></i> {{blog.likesCount}} {{blog.likesCount === 1 ? 'like' : 'likes'}}</span>
            <span><i class="fa-regular fa-comments"></i> {{blog.commentsCount}} {{blog.commentsCount === 1 ? 'comment' : 'comments'}}</span>
        </div>
        <div class="actions">
            <button routerLink="/blogs"><i class="fa-solid fa-arrow-left"></i>Back</button>
            @if (isAuthor) {
                <button [routerLink]="['/blogs', 'edit', blog.slug]"><i class="fa-solid fa-pencil"></i>Edit</button>
                <button (click)="deleteBlog(blog._id)" [disabled]="isSubmitting"><i class="fa-solid fa-trash"></i>{{isSubmitting ? 'Deleting' : 'Delete'}}</button>
            } @else {
                <button (click)="toggleLike()" [disabled]="isLiking"><i class="fa-regular fa-thumbs-up"></i> {{hasLiked ? 'Unlike' : 'Like'}}</button>
            }
        </div>
    </footer>

    <section class="author-box">
        <h3>About the Author</h3>
        <p>{{blog.author.firstName}} is a digital nomad exploring Europe one city at a time. The author loves writing, coffee,
            and old bookstores.
        </p>
    </section>

    <section class="related-posts">
        <h3>See More Posts From {{blog.author.firstName}}</h3>
        <ul>
            <li><a href="#">A Foodies Guide to Porto</a></li>
            <li><a href="#">Top 10 Beaches in Southern Spain</a></li>
        </ul>
    </section>

    <app-comment [blog]="blog" />
</article>